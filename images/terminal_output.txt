PS C:\script\python> py .\talib_rf_predict05d.py NVDA 10 C:\\intel\\tmp
Starting multi-class sliding window prediction model...
Loading multi-class dataset...
Loading dataset...
[*********************100%***********************]  1 of 1 completed
Dataset shape: (2477, 10)
Creating sliding window features with window size 10...
Sliding window X shape: (2468, 80)
Target shape: (2468,)
Training data shape: (2458, 80), (2458,)
Target classes: [-2, -1, 0, 1, 2]
Training Random Forest Classification model for multi-class problem...
Model trained successfully!

Model Evaluation:
Accuracy: 0.5102

Generating predictions for all data points...

Predictions for the last 10 rows (future predictions):
           date  predicted_target1  prob_class_-2  prob_class_-1  prob_class_0  prob_class_1  prob_class_2
2458 2025-03-11                  0       0.027024       0.077202      0.405948      0.359891      0.129935
2459 2025-03-12                  1       0.071112       0.106218      0.297869      0.341895      0.182906
2460 2025-03-13                  1       0.078943       0.132997      0.238572      0.345285      0.204203
2461 2025-03-14                  1       0.079349       0.249104      0.222090      0.302085      0.147372
2462 2025-03-17                 -1       0.076433       0.324325      0.257043      0.213218      0.128981
2463 2025-03-18                 -1       0.068432       0.319259      0.240611      0.264642      0.107056
2464 2025-03-19                 -1       0.067207       0.482924      0.207085      0.191639      0.051145
2465 2025-03-20                 -1       0.156388       0.469793      0.121483      0.183465      0.068870
2466 2025-03-21                 -1       0.297349       0.362623      0.165872      0.160985      0.013170
2467 2025-03-24                 -2       0.439722       0.349954      0.117044      0.056326      0.036954

Historical predictions (showing last 20 rows):
           date  predicted_target1 actual_target1  prob_class_-2  prob_class_-1  prob_class_0  prob_class_1  prob_class_2  is_future
2438 2025-02-10                 -1             -1       0.020083       0.517353      0.321315      0.107406      0.033843      False
2439 2025-02-11                  0              0       0.009311       0.239575      0.611336      0.094006      0.045773      False
2440 2025-02-12                 -1             -1       0.048878       0.639140      0.196945      0.083748      0.031289      False
2441 2025-02-13                 -1             -1       0.049512       0.735499      0.107091      0.086861      0.021037      False
2442 2025-02-14                 -2             -2       0.700107       0.177625      0.067284      0.046959      0.008025      False
2443 2025-02-18                 -2             -2       0.827222       0.098758      0.051928      0.016765      0.005327      False
2444 2025-02-19                 -2             -2       0.908148       0.037407      0.045926      0.007778      0.000741      False
2445 2025-02-20                 -2             -2       0.938889       0.050000      0.000000      0.011111      0.000000      False
2446 2025-02-21                 -2             -2       0.944444       0.011111      0.022222      0.000000      0.022222      False
2447 2025-02-24                 -2             -2       0.922222       0.033333      0.032791      0.000000      0.011653      False
2448 2025-02-25                 -2             -2       0.900855       0.069801      0.022792      0.005128      0.001425      False
2449 2025-02-26                 -2             -2       0.835901       0.056209      0.065640      0.023203      0.019048      False
2450 2025-02-27                 -1             -1       0.082885       0.695050      0.166262      0.027243      0.028560      False
2451 2025-02-28                 -1             -1       0.018846       0.758767      0.173954      0.033041      0.015392      False
2452 2025-03-03                  0              0       0.052071       0.098434      0.709743      0.108765      0.030987      False
2453 2025-03-04                  0              0       0.026606       0.049322      0.759066      0.146354      0.018652      False
2454 2025-03-05                  0              0       0.029191       0.120560      0.670985      0.108920      0.070344      False
2455 2025-03-06                  1              1       0.016852       0.073677      0.169281      0.708499      0.031690      False
2456 2025-03-07                  0              0       0.021011       0.071554      0.750604      0.090443      0.066388      False
2457 2025-03-10                  1              1       0.031771       0.068053      0.155295      0.684852      0.060029      False

Performance metrics on historical data:
Accuracy: 0.9296

Generating confusion matrix...
Done!